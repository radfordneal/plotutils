# This is the Makefile for spline(1).

VERSION = @VERSION@

top_srcdir = @top_srcdir@
srcdir = @srcdir@
VPATH  = @srcdir@

SHELL = /bin/sh

CC = @CC@
CFLAGS = @CFLAGS@
INSTALL = @INSTALL@
INSTALL_DATA = @INSTALL_DATA@
INSTALL_PROGRAM = @INSTALL_PROGRAM@
LDFLAGS = @LDFLAGS@
LIBS = @LIBS@
RANLIB = @RANLIB@

prefix = @prefix@
exec_prefix = @exec_prefix@
bindir = @bindir@
infodir = @infodir@
libdir = @libdir@
includedir = @includedir@
oldincludedir = @oldincludedir@
mandir = @mandir@

######################################################################

PROGRAM = spline

SRCS = spline.c
OBJS = spline.o

INCLUDES=-I.. -I$(top_srcdir)/include -I$(top_srcdir)/getopt

GETOPT=../getopt

all: $(PROGRAM)

.PHONY: all install uninstall clean realclean distclean install-man

.SUFFIXES:
.SUFFIXES: .c .o

.c.o:
	$(CC) -DVERSION=\"$(VERSION)\" $(CFLAGS) $(INCLUDES) -c $<

$(PROGRAM): $(OBJS) $(GETOPT)/getopt.o $(GETOPT)/getopt1.o
	$(CC) $(CFLAGS) $(OBJS) $(GETOPT)/getopt.o $(GETOPT)/getopt1.o $(LIBS) $(LDFLAGS) -o $@

$(GETOPT)/getopt.o $(GETOPT)/getopt1.o: $(top_srcdir)/getopt/getopt.c $(top_srcdir)/getopt/getopt1.c
	cd $(GETOPT); $(MAKE) all CC="$(CC)" CFLAGS="$(CFLAGS)"

install: $(PROGRAM)
	$(top_srcdir)/mkdirs.sh $(bindir)
	$(INSTALL_PROGRAM) $(PROGRAM) $(bindir)/$(PROGRAM)

install-man:  $(PROGRAM).man
	$(top_srcdir)/mkdirs.sh $(mandir) $(mandir)/man1
	-$(INSTALL_DATA) $(srcdir)/$(PROGRAM).man $(mandir)/man1/$(PROGRAM).1

uninstall:
	-rm -f $(bindir)/$(PROGRAM)
	-rm -f $(mandir)/man1/$(PROGRAM).1

clean:
	-rm -f *.o $(PROGRAM) core test* data*

distclean: clean
	-rm -f \#* *~ TAGS Makefile

realclean: distclean

TAGS: $(SRCS) $(top_srcdir)/include/sys-defines.h $(srcdir)/extern.h $(top_srcdir)/getopt/getopt.h
	cd $(srcdir) && etags $(SRCS) ../include/sys-defines.h extern.h ../getopt/getopt.h

######################################################################
# dependencies generated by gcc -c -MM *.c -I etc.
######################################################################

spline.o: spline.c  $(top_srcdir)/include/sys-defines.h $(top_srcdir)/getopt/getopt.h
